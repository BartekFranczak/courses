<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="W. Gryglas, eng. T.Wacławczyk" />


<title>cs2_lab05.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CCFD Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Info I
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://github.com/ccfd/courses_graphics/archive/master.zip">Projekt z biblioteką graficzną</a>
    </li>
    <li>
      <a href="info1_tworzenie_projektu.html">Instrukcja tworzenia projektu</a>
    </li>
    <li>
      <a href="info1_lab01.html">Instrukcja I</a>
    </li>
    <li>
      <a href="info1_lab02.html">Instrukcja II</a>
    </li>
    <li>
      <a href="info1_lab03.html">Instrukcja III</a>
    </li>
    <li>
      <a href="info1_lab04.html">Instrukcja IV</a>
    </li>
    <li>
      <a href="info1_lab05.html">Instrukcja V</a>
    </li>
    <li>
      <a href="info1_lab06.html">Instrukcja VI</a>
    </li>
    <li>
      <a href="info1_lab07.html">Instrukcja VII</a>
    </li>
    <li>
      <a href="info1_lab08.html">Instrukcja VIII</a>
    </li>
    <li>
      <a href="info1_lab09.html">Instrukcja IX</a>
    </li>
    <li>
      <a href="info1_lab10.html">Instrukcja X</a>
    </li>
    <li>
      <a href="info1_arkusz_kalkulacyjny.html">Arkusz kalkulacyjny</a>
    </li>
    <li>
      <a href="info1_projekty.html">Projekty</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Info II
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="info2_regulamin.html">Regulamin</a>
    </li>
    <li>
      <a href="info2_lab01.html">Instrukcja I</a>
    </li>
    <li>
      <a href="info2_lab02.html">Instrukcja II</a>
    </li>
    <li>
      <a href="info2_lab03.html">Instrukcja III</a>
    </li>
    <li>
      <a href="info2_lab04.html">Instrukcja IV</a>
    </li>
    <li>
      <a href="info2_lab05.html">Instrukcja V</a>
    </li>
    <li>
      <a href="info2_lab06.html">Instrukcja VI</a>
    </li>
    <li>
      <a href="info2_training_exercises.html">Zadania treningowe</a>
    </li>
    <li>
      <a href="info2_projekty.html">Zadania domowe</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    CS II
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="cs2_rules.html">Rules</a>
    </li>
    <li>
      <a href="cs2_lab01.html">Instruction I</a>
    </li>
    <li>
      <a href="cs2_lab02.html">Instruction II</a>
    </li>
    <li>
      <a href="cs2_lab03.html">Instruction III</a>
    </li>
    <li>
      <a href="cs2_lab04.html">Instruction IV</a>
    </li>
    <li>
      <a href="cs2_lab05.html">Instruction V</a>
    </li>
    <li>
      <a href="cs2_lab06.html">Instruction VI</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Info III
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="info3_informacje.html">Regulamin i Informacje</a>
    </li>
    <li>
      <a href="info3_lab_1.html">Instrukcja I</a>
    </li>
    <li>
      <a href="info3_lab_2-3.html">Instrukcja II - III</a>
    </li>
    <li>
      <a href="info3_lab_4.html">Instrukcja IV</a>
    </li>
    <li>
      <a href="info3_lab_5.html">Instrukcja V</a>
    </li>
    <li>
      <a href="info3_lab_6.html">Instrukcja VI</a>
    </li>
    <li>
      <a href="info3_lab_7.html">Instrukcja VII</a>
    </li>
    <li>
      <a href="info3_lab_dodatki.html">Bash: Dodatki</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Met Num
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="metnum_lab1.html">Instrukcja I</a>
    </li>
    <li>
      <a href="metnum_lab2.html">Instrukcja II</a>
    </li>
    <li>
      <a href="metnum_lab3.html">Instrukcja III</a>
    </li>
    <li>
      <a href="metnum_lab4.html">Instrukcja IV</a>
    </li>
    <li>
      <a href="metnum_lab5.html">Instrukcja V</a>
    </li>
    <li>
      <a href="metnum_lab6.html">Instrukcja VI</a>
    </li>
    <li>
      <a href="metnum_lab7.html">Instrukcja VII</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    C++
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="cpp_rules.html">Regulamin przedmiotu</a>
    </li>
    <li>
      <a href="cpp_inst01.html">Instrukcja I</a>
    </li>
    <li>
      <a href="cpp_inst02.html">Instrukcja II</a>
    </li>
    <li>
      <a href="cpp_inst03.html">Instrukcja III</a>
    </li>
    <li>
      <a href="cpp_inst04.html">Instrukcja IV</a>
    </li>
    <li>
      <a href="cpp_inst05.html">Instrukcja V</a>
    </li>
    <li>
      <a href="cpp_inst06.html">Instrukcja VI</a>
    </li>
    <li>
      <a href="cpp_inst07.html">Instrukcja VII</a>
    </li>
    <li>
      <a href="cpp_inst01b.html">Instrukcja Ib</a>
    </li>
    <li>
      <a href="cpp_inst02b.html">Instrukcja IIb</a>
    </li>
    <li>
      <a href="cpp_inst03b.html">Instrukcja IIIb</a>
    </li>
    <li>
      <a href="cpp_inst04b.html">Instrukcja IVb</a>
    </li>
    <li>
      <a href="cpp_inst05b.html">Instrukcja Vb</a>
    </li>
    <li>
      <a href="cpp_projects.html">Lista projektów</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Python
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="python_inst01.html">Instrukcja I</a>
    </li>
    <li>
      <a href="python_inst02.html">Instrukcja II</a>
    </li>
    <li>
      <a href="python_inst03.html">Instrukcja III</a>
    </li>
    <li>
      <a href="python_inst04.html">Instrukcja IV</a>
    </li>
    <li>
      <a href="python_inst05.html">Instrukcja V</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    KAP/ACFD
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="kap_lab.html">Informacje</a>
    </li>
    <li>
      <a href="kap_lab01.html">Instrukcja I</a>
    </li>
    <li>
      <a href="kap_lab02.html">Instrukcja II</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="cs2_lab05.pdf">
    <span class="fa fa-file-pdf-o fa-lg"></span>
     
    Download PDF
  </a>
</li>
<li>
  <a href="https://github.com/ccfd/courses/edit/master/cs2_lab05.Rmd">
    <span class="fa fa-github fa-lg"></span>
     
    Edit on GitHub
  </a>
</li>
<li>
  <a href="https://en.wikipedia.org/wiki/Creative_Commons_license">
    <span class="fa fa-creative-commons fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- Dummy header -->

<div class="fluid-row" id="header">




</div>


<div id="numerical-solution-of-higher-order-ordinary-differential-equations" class="section level1">
<h1>Numerical solution of higher-order ordinary differential equations</h1>
<p>Files for the present tutorial can be found using following links:</p>
<ul>
<li><a href="http://ccfd.github.io/courses/code/info2/rk4.h">Header file rk4.h</a></li>
<li><a href="http://ccfd.github.io/courses/code/info2/rk4.cpp">Source file rk4.cpp</a></li>
</ul>
<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<p>During previous laboratory we have learned how to integrate single ordinary differential equation (ODE) in the initial value problem. Introduced numerical methods allow for finding the function <span class="math inline">\(y(t)\)</span> which satisfies arbitrary first order differential equation: <span class="math display">\[ \frac{dy}{dt} = f(t, y(t)) \]</span> with the initial condition <span class="math inline">\(y(t=t_0)=y_0\)</span>. However, in may situations we have to solve simultaneously two or more ODE’s which are coupled with each other, for example by the functions on their right hand sides: <span class="math display">\[ 
\begin{aligned}
\frac{dx}{dt} &amp;= sin(y) + cos(x) \cdot t \\
\frac{dy}{dt} &amp;= sin(y) \cdot t + cos(x)
\end{aligned}
\]</span> As you can observe in the above set of the two first order ODE’s, during their solutions we search for the functions <span class="math inline">\(x = x(t)\)</span> and <span class="math inline">\(y=y(t)\)</span>. However, the RHS of these equations are both dependent on <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>. Hence, to solve first equation for <span class="math inline">\(x(t)\)</span> we need to know how <span class="math inline">\(y(t)\)</span> is changing in time. To solve second equation for <span class="math inline">\(y(t)\)</span> we need to know how <span class="math inline">\(x(t)\)</span> is changing in time. Therefore, these two equations are strongly coupled. To solve this problem we have to integrate both equations simultaneously. This is the main topic of the present laboratory for its solution we use knowledge we gathered during the previous classes during solution of the initial value problem.</p>
<p>The issue of the numerical solution of the set of first-order ODE’s very often is related to problems which are described by higher order ODE’s. Here, the most common one are the second-order differential equations especially in the models describing dynamics of the mechanical systems, e.g., movement of the solid body or material point under action of external forces. These equations typically read: <span class="math display">\[ \frac{d^2x}{dt^2} = f(t, x, \frac{dx}{dt}) \]</span> Each second-order ODE, can be reformulated into the form of the set of two <strong>first- order</strong> ODE’s: <span class="math display">\[ 
\begin{aligned}
\frac{dv_x}{dt} &amp;= f_1(t, x, v_x) \\
\frac{dx}{dt} &amp;= v_x
\end{aligned}
\]</span></p>
<p>Above set of equations can be reduced to the single second-order equation (by substitution). Their solutions are therefore corresponding. Note, the unknown functions to dertermine here are <span class="math inline">\(v_x(t)\)</span> and <span class="math inline">\(x(t)\)</span>. For this reason we also need two initial conditions for instance at <span class="math inline">\(t=0\)</span>: <span class="math inline">\(v_x(t=0)=v_0\)</span> and <span class="math inline">\(x(t=0)=x_0\)</span>, where <span class="math inline">\(v_0\)</span>, <span class="math inline">\(x_0\)</span> are known values.</p>
</div>
<div id="numerical-integration-of-the-set-of-odes" class="section level2">
<h2>2. Numerical integration of the set of ODE’s</h2>
<p>We already know two numerical techniques that can be used to integrate the first-order ODE in time, namely:</p>
<ul>
<li>Euler method</li>
<li>Rungego-Kutta method.</li>
</ul>
<p>These two iterative methods allow to find the values of the unknown function(s) in the next time moments (time levels). In the case of the sets of ODE’s we use similar approach. First we compute the value of the functions based on the previous solution. The difference is that the next integration step must be performed for all equations in the given system. Let us consider set of equations:</p>
<p><span class="math display">\[ 
\begin{aligned}
\frac{dx}{dt} &amp;= sin(y) + cos(x) \cdot t \\
\frac{dy}{dt} &amp;= sin(y) \cdot t + cos(x)
\end{aligned}
\]</span> with initial conditions: <span class="math display">\[
x(t=0) = 0 \\
y(t=0) = 0
\]</span></p>
<p>For the above system of equations, integration using the Euler’s method can be described using the following algorithm:</p>
<ol style="list-style-type: decimal">
<li><p>Set <span class="math inline">\(x_0 = x(t=0)\)</span>, <span class="math inline">\(y_0 = y(t=0)\)</span>, the integration strart at <span class="math inline">\(t=0\)</span>, choose the time step size <span class="math inline">\(dt\)</span>, e.g. <span class="math inline">\(dt = 0.001\)</span>.</p></li>
<li>Compute derivatives of functions <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> using known values <span class="math inline">\(x_0, y_0, t\)</span>, in this case: <span class="math display">\[
dxdt = sin(y_0) + cos(x_0) \cdot t = sin(0) + cos(0) \cdot 0 = 0 \\
dydt = sin(y_0) \cdot 0 + cos(x_0) = sin(0) \cdot 0 + cos(0) = 1
\]</span></li>
<li>Using values of the drivatives obtained at time <span class="math inline">\(t=0\)</span> compute new values of functions <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> at the next time level: <span class="math display">\[
x = x_0 + dt  \cdot  dxdt = 0 + 0.001 \cdot 0 = 0 \\
y = y_0 + dt  \cdot  dydt = 0 + 0.001 \cdot 1 = 0.001
\]</span></li>
<li>Update the variables setting: <span class="math display">\[
x_0 = x = 0, \quad
y_0 = y = 0.001, \quad
t = t + dt = 0.001
\]</span></li>
<li><p>Goto point 2. and repeat all operations until variable <span class="math inline">\(t\)</span> equals its final value <span class="math inline">\(T\)</span> (<span class="math inline">\(T\)</span> is set by the user).</p></li>
</ol>
<p>Using above algorithm one can obtain the results presented on the figure below in time [0,T], here <span class="math inline">\(T=1\)</span>.</p>
<p><img src="cs2_lab05_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>The above algorithm can be easily reformulated in order to use Runge-Kutta method. The only difference is in the way how the right hand sides are calculated, i.e., how variables <span class="math inline">\(dxdt\)</span> and <span class="math inline">\(dydt\)</span> are updated.</p>
<div id="exercises" class="section level3">
<h3>Exercises</h3>
<ol style="list-style-type: decimal">
<li>Implement described algorithm into your program and integrate the set of ODE’s as described above.</li>
<li>The results of the integration, i.e., values of the functions <span class="math inline">\(x(t)\)</span>, <span class="math inline">\(y(t)\)</span> write in arrays <code>X</code>, <code>Y</code> for each time step.</li>
<li>Present <span class="math inline">\(X(t)\)</span>, <span class="math inline">\(Y(t)\)</span> on the diagram using graphical library.</li>
<li>Modify your program in a way allowing to use RK-4 method (use your experience from previous classes).</li>
</ol>
</div>
</div>
<div id="transformation-of-higher-order-ode-to-set-of-first-order-odes" class="section level2">
<h2>3. Transformation of higher-order ODE to set of first-order ODE’s</h2>
<p>In order to use Euler’s or RK-4 method to problems described by higher-order differential equations, one needs to transform higher-order equation into a set of the first-order differential equations.</p>
<div class="figure">
<img src="figures/info2/inst5/carriage.png" title="Problem do rozwiązania" alt="Cart" />
<p class="caption">Cart</p>
</div>
<p>Let us consider the problem that is depicted on the above figure.</p>
<p>The movement of the cart (assuming that initially the spring is not streached and mass of the cart wheels is negligible) can be described using equation resulting from the III law of Newton’s dynamics: <span class="math display">\[ F_{cart} = - k\cdot x = m \cdot a\]</span> knowing that acceleration is the second derivative of the cart position in time we can write: <span class="math display">\[ \frac{d^2x}{dt^2} = - \frac{k}{m} \cdot x \]</span></p>
<p>Beside the equation, we also need initial conditions. As considered equation is second-order, two initial conditions are needed. In this case we can assume that initial position of the cart is located at the beginning of the coordinate system: <span class="math display">\[ x(t=0) = 0 \]</span> and, that initially the cart is at rest: <span class="math display">\[ \frac{dx}{dt}(t=0)=0 \]</span> Next, we have to reformulate above problem to the set of two first-order ODE’s. It can be done in several different ways, for example using canonical equations (they introduce pair: position, momentum). As our case is simple, we note that introduction of a new variable - <span class="math inline">\(v\)</span> and substitution <span class="math display">\[ v = \frac{dx}{dt} \]</span> is sufficent to obtain an additional equation. This new equation relates velocity and position. Using above to the second order ODE we note: <span class="math display">\[ \frac{d^2x}{dt^2} = \frac{d}{dt} (\frac{dx}{dt}) = \frac{dv}{dt} = -\frac{k}{m}x \]</span> The same operation must be repeated for initial conditions. Finally we obtain following set of the first-order ODE’s: <span class="math display">\[
\frac{dv}{dt} = -\frac{k}{m} x \\
\frac{dx}{dt} = v \\
x(t=0) = 0 \\
v(t=0) = 0
\]</span></p>
<div id="exercises-1" class="section level3">
<h3>Exercises</h3>
<p>The movement of the mathematical pendulum (neglecting air reistance and assuming the line is massless and not extendable) is described by the following ordinary differential equation with the initial conditions: <span class="math display">\[
\begin{aligned}
&amp;\frac{d^2\alpha}{dt^2} = -\frac{g}{l}sin(\alpha) \\
&amp;\alpha(t_0) = \alpha_0 \\
&amp;\frac{d\alpha}{dt}(t_0) = \omega_0
\end{aligned}
\]</span> where:</p>
<p><span class="math inline">\(\alpha\)</span> - the angle describing deviation of the pendulum from its equilibrium position,</p>
<p><span class="math inline">\(g\)</span> - gravitational acceleration,</p>
<p><span class="math inline">\(l\)</span> - the length of pendulum line,</p>
<p><span class="math inline">\(m\)</span> - the mass of pendulum.</p>
<ol style="list-style-type: decimal">
<li><p>Transform above second-order equation to the set of first-order ordinary differential equations.</p></li>
<li><p>Write a program using RK-4 method which computes <span class="math inline">\(\alpha(t)\)</span> - angular position and <span class="math inline">\(\omega(t) = \frac{d\alpha}{dt}\)</span> - angular velocity in time <span class="math inline">\(t \in \left[0,10\right]\)</span></p></li>
<li>Additionaly, compute how the totoal mechanical energy <span class="math inline">\(E(t)\)</span> is changing in time. The total mechanical energy of pendulum reads: <span class="math display">\[E = \frac{ml^2}{2}(\frac{d\alpha}{dt})^2 + mgl(1-cos(\alpha))\]</span> <strong>Note</strong>: In the case with zero dissipation the total mechanical energy should be constant.</li>
<li><p>Repeat computations using different values of the time step size <span class="math inline">\(\Delta t\)</span>.</p></li>
</ol>
</div>
</div>
</div>

<!-- Dummy footer -->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "site_libs/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
